{
  "$schema": "../../../schema/m3-room.schema.json",
  "id": 60,
  "name": "Pink Brinstar Power Bomb Room",
  "area": "Brinstar",
  "subarea": "Pink",
  "playable": true,
  "roomAddress": "0x79E11",
  "roomEnvironments": [{"heated": false}],
  "nodes": [
    {
      "id": 1,
      "name": "Top Right Door",
      "nodeType": "door",
      "nodeSubType": "grey",
      "nodeAddress": "0x0018e62",
      "doorEnvironments": [{"physics": "air"}],
      "leaveWithGModeSetup": [
        {"strats": [
          {
            "name": "Get Hit By Sidehopper",
            "notable": false,
            "requires": [],
            "note": "It's fastest to kill the first hopper safely from inside the doorway, then lure the second one over."
          }
        ]}
      ],
      "gModeImmobile": {
        "requires": [
          {"enemyDamage": {
            "enemy": "Sidehopper",
            "type": "contact",
            "hits": 1
          }}
        ]
      },
      "locks": [
        {
          "name": "Mission Impossible Grey Lock (to Big Pink Upper)",
          "lockType": "killEnemies",
          "unlockStrats": [
            {
              "name": "Base",
              "notable": false,
              "requires": [
                {"obstaclesCleared": ["A"]}
              ],
              "devNote": "Obstacle must be destroyed by going to 4 and back."
            }
          ],
          "yields": ["f_ZebesAwake"]
        }
      ]
    },
    {
      "id": 2,
      "name": "Bottom Right Door",
      "nodeType": "door",
      "nodeSubType": "blue",
      "nodeAddress": "0x0018e6e",
      "doorEnvironments": [{"physics": "air"}]
    },
    {
      "id": 3,
      "name": "Item",
      "nodeType": "item",
      "nodeSubType": "visible",
      "nodeItem": "PowerBomb",
      "nodeAddress": "0x7865C"
    },
    {
      "id": 4,
      "name": "Top Left Junction",
      "nodeType": "junction",
      "nodeSubType": "junction",
      "note": "The top left section of the room, where the Super block is"
    }
  ],
  "obstacles": [
    {
      "id": "A",
      "name": "Sidehoppers",
      "obstacleType": "enemies"
    },
    {
      "id": "B",
      "name": "Mission Impossible: Return through the Crumble Block",
      "obstacleType": "abstract"
    }
  ],
  "enemies": [
    {
      "id": "e1",
      "groupName": "Mission Impossible Sidehoppers",
      "enemyName": "Sidehopper",
      "quantity": 2,
      "homeNodes": [1, 4]
    }
  ],
  "links": [
    {
      "from": 1,
      "to": [
        {"id": 1},
        {"id": 4}
      ]
    },
    {
      "from": 2,
      "to": [
        {"id": 1},
        {"id": 2},
        {"id": 3}
      ]
    },
    {
      "from": 3,
      "to": [
        {"id": 2},
        {"id": 4}
      ]
    },
    {
      "from": 4,
      "to": [
        {"id": 1},
        {"id": 3}
      ]
    }
  ],
  "strats": [
    {
      "link": [1, 1],
      "name": "Leave With Runway",
      "requires": [
        {"obstaclesCleared": ["A"]}
      ],
      "exitCondition": {
        "leaveWithRunway": {
          "length": 3,
          "openEnd": 1
        }
      }
    },
    {
      "link": [1, 1],
      "name": "Leave Shinecharged (Unbroken Super Block)",
      "requires": [
        {"obstaclesCleared": ["A"]},
        {"obstaclesNotCleared": ["B"]},
        {"canShineCharge": {
          "usedTiles": 16,
          "openEnd": 0
        }}
      ],
      "exitCondition": {
        "leaveShinecharged": {
          "framesRemaining": 60
        }
      },
      "devNote": "Spikes cannot be used as openEnds."
    },
    {
      "link": [1, 1],
      "name": "Leave Shinecharged (Spike I-frames, Unbroken Super Block)",
      "requires": [
        {"obstaclesCleared": ["A"]},
        {"obstaclesNotCleared": ["B"]},
        {"canShineCharge": {
          "usedTiles": 23,
          "openEnd": 0
        }},
        {"spikeHits": 1},
        "canIframeSpikeJump",
        "canShinechargeMovementComplex"
      ],
      "exitCondition": {
        "leaveShinecharged": {
          "framesRemaining": 62
        }
      },
      "note": [
        "Stand to the right of the center spike",
        "Run to the left, and continue running left while getting knocked back right by the spike.",
        "The spike i-frames allow shortcharging while running through the left two spike blocks.",
        "After gaining a shinecharge, turn back right, run, and jump through the door."
      ],
      "devNote": "Spikes cannot be used as openEnds."
    },
    {
      "link": [1, 1],
      "name": "Leave Shinecharged (X-Mode)",
      "requires": [
        {"obstaclesCleared": ["A"]},
        "SpeedBooster",
        "h_canXMode",
        "h_XModeSpikeHit",
        "h_XModeSpikeHit",
        "canShinechargeMovement"
      ],
      "exitCondition": {
        "leaveShinecharged": {
          "framesRemaining": 100
        }
      },
      "devNote": "Two spike hits are expected per attempt (with any additional leniency hits being multiplied by this amount)."
    },
    {
      "link": [1, 1],
      "name": "Crystal Flash",
      "requires": [
        {"obstaclesCleared": ["A"]},
        "h_canCrystalFlash"
      ]
    },
    {
      "link": [1, 4],
      "name": "Tank the Damage while Running Through",
      "requires": [
        {"enemyDamage": {
          "enemy": "Sidehopper",
          "type": "contact",
          "hits": 1
        }},
        {"or": [
          {"enemyDamage": {
            "enemy": "Sidehopper",
            "type": "contact",
            "hits": 1
          }},
          {"spikeHits": 1},
          {"and": [
            {"doorUnlockedAtNode": 1},
            "canDodgeWhileShooting"
          ]}
        ]}
      ],
      "note": [
        "2 hits are expected to be taken.",
        "The first can be either from a Sidehopper or from a spike.",
        "Second hit will be from a Sidehopper.",
        "It is possible to avoid the first hit by opening the door and standing in the doorway while killing the first hopper."
      ]
    },
    {
      "link": [1, 4],
      "name": "Power Beam Sidehopper Kill",
      "requires": [
        {"enemyDamage": {
          "enemy": "Sidehopper",
          "type": "contact",
          "hits": 6
        }}
      ],
      "clearsObstacles": ["A"],
      "devNote": "FIXME: Coming in with blue or sparking may be another way to kill the Hoppers."
    },
    {
      "link": [1, 4],
      "name": "Morph Power Beam Sidehopper Kill",
      "requires": [
        {"enemyDamage": {
          "enemy": "Sidehopper",
          "type": "contact",
          "hits": 3
        }},
        "Morph",
        "canDodgeWhileShooting"
      ],
      "clearsObstacles": ["A"],
      "note": "Morph reduces damage because the ceiling Sidehopper can't reach a Morphed Samus."
    },
    {
      "link": [1, 4],
      "name": "Intermediate Weapon Sidehopper Kill",
      "requires": [
        {"enemyDamage": {
          "enemy": "Sidehopper",
          "type": "contact",
          "hits": 2
        }},
        {"or": [
          "Spazer",
          "canPseudoScrew",
          "Wave"
        ]}
      ],
      "clearsObstacles": ["A"],
      "note": "Pseudo Screw can help with the Sidehopper kills."
    },
    {
      "link": [1, 4],
      "name": "Morph Intermediate Weapon Sidehopper Kill",
      "requires": [
        {"enemyDamage": {
          "enemy": "Sidehopper",
          "type": "contact",
          "hits": 1
        }},
        "Morph",
        "canDodgeWhileShooting",
        {"or": [
          "Spazer",
          "Wave"
        ]}
      ],
      "clearsObstacles": ["A"],
      "note": "Morph reduces damage because the ceiling Sidehopper can't reach a morphed Samus."
    },
    {
      "link": [1, 4],
      "name": "Good Weapon Sidehopper Kill",
      "requires": [
        {"enemyDamage": {
          "enemy": "Sidehopper",
          "type": "contact",
          "hits": 1
        }},
        {"enemyKill": {
          "enemies": [
            ["Sidehopper"],
            ["Sidehopper"]
          ],
          "explicitWeapons": ["Missile"]
        }}
      ],
      "clearsObstacles": ["A"]
    },
    {
      "link": [1, 4],
      "name": "Safe Weapon Sidehopper Kill",
      "requires": [
        {"enemyKill": {
          "enemies": [
            ["Sidehopper"],
            ["Sidehopper"]
          ],
          "explicitWeapons": [
            "Super",
            "PowerBomb",
            "ScrewAttack",
            "Plasma",
            "Wave+Spazer"
          ]
        }}
      ],
      "clearsObstacles": ["A"],
      "note": "All beam weapons that can take out a Sidehopper in 5 hits or less can reliably take out the Sidehoppers damage-free."
    },
    {
      "link": [1, 4],
      "name": "Doorway Sidehopper Kill",
      "requires": [
        {"doorUnlockedAtNode": 1},
        "canDodgeWhileShooting",
        {"or": [
          "Morph",
          "Spazer",
          "Wave",
          "Plasma",
          {"enemyKill": {
            "enemies": [["Sidehopper"]],
            "explicitWeapons": ["Missile"]
          }},
          {"enemyDamage": {
            "enemy": "Sidehopper",
            "type": "contact",
            "hits": 2
          }},
          "canTrickyJump"
        ]}
      ],
      "clearsObstacles": ["A"],
      "note": [
        "Open the door and kill the first hopper from inside the doorway. It won't be able to hit Samus for many jumps.",
        "It is possible to quickly get back to the right and crouch against the the ledge while aiming upward to safely kill the Sidehopper.",
        "Alternatively, morph can help with the second hopper, as it won't be able to hit Samus."
      ]
    },
    {
      "link": [1, 4],
      "name": "G-Mode Morph Power Bomb Kill",
      "requires": [
        {"comeInWithGMode": {
          "fromNodes": [1],
          "mode": "any",
          "artificialMorph": true
        }},
        {"ammo": {"type": "PowerBomb", "count": 1}},
        {"or": [
          {"and": [
            {"ammo": {"type": "PowerBomb", "count": 1}},
            {"or": [
              "h_canArtificialMorphBombHorizontally",
              "SpringBall"
            ]}
          ]},
          {"enemyDamage": {
            "enemy": "Sidehopper",
            "hits": 1,
            "type": "contact"
          }}
        ]}
      ],
      "clearsObstacles": ["A"],
      "note": "Use 1-3 Power Bombs to kill the Sidehoppers."
    },
    {
      "link": [2, 1],
      "name": "X-Ray Climb",
      "entranceCondition": {
        "comeInWithDoorStuckSetup": {}
      },
      "requires": [
        "canXRayClimb"
      ],
      "note": "Climb up 1 screen."
    },
    {
      "link": [2, 1],
      "name": "Very Deep Stuck X-Ray Climb",
      "entranceCondition": {
        "comeInWithGMode": {
          "mode": "direct",
          "morphed": false
        }
      },
      "requires": [
        "canXRayClimb"
      ],
      "bypassesDoorShell": true,
      "note": [
        "Enter with G-mode direct, back up to between 1 and 6 pixels from the door transition, and activate X-ray to get very deep stuck in the door.",
        "Climb up 1 screen, and perform a turnaround buffered spin-jump away from the door to trigger the transition, bypassing any lock on the door."
      ]
    },
    {
      "link": [2, 2],
      "name": "Leave With Runway",
      "requires": [],
      "exitCondition": {
        "leaveWithRunway": {
          "length": 4,
          "openEnd": 0
        }
      }
    },
    {
      "link": [2, 3],
      "name": "Pink Brinstar Power Bombs Crystal Flash Clip",
      "notable": true,
      "requires": [
        "h_canCrystalFlash",
        "canCeilingClip"
      ],
      "note": [
        "Perform the crystal flash all the way to the left, against the crumble blocks to prevent the elevator on the right from blocking you in.",
        "Simply jump after performing the crystal flash to jump through the floor."
      ]
    },
    {
      "link": [2, 3],
      "name": "G-Mode Morph Overload PLMs with Bombs",
      "requires": [
        {"comeInWithGMode": {
          "fromNodes": [2],
          "mode": "any",
          "artificialMorph": true
        }},
        "Bombs"
      ],
      "note": "Place Power Bombs against the side of the crumble block until PLMs are overloaded, then go through."
    },
    {
      "link": [2, 3],
      "name": "G-Mode Morph Direct Overload PLMs with Power Bombs",
      "requires": [
        {"comeInWithGMode": {
          "fromNodes": [2],
          "mode": "direct",
          "artificialMorph": true
        }},
        {"itemNotCollectedAtNode": 3},
        {"ammo": {"type": "PowerBomb", "count": 2}},
        {"or": [
          "SpringBall",
          {"ammo": {"type": "PowerBomb", "count": 4}},
          {"and": [
            "Morph",
            {"or": [
              "can3HighMidAirMorph",
              {"ammo": {"type": "PowerBomb", "count": 2}}
            ]}
          ]}
        ]}
      ],
      "note": "Place two Power Bombs, precisely on the third tile in the morph tunnel to overload PLMs (watch the right side of the screen).",
      "devNote": [
        "Because of the gates, it costs 2 Power Bombs to get into the tunnel and 2 to get out the other side.",
        "There is no canRiskPermanentLossOfAccess, because there is no reason to go here except to get the item and leave."
      ]
    },
    {
      "link": [3, 2],
      "name": "Base",
      "requires": [
        "h_canBombThings"
      ]
    },
    {
      "link": [3, 4],
      "name": "Mission Impossible",
      "notable": true,
      "requires": [
        "canQuickCrumbleEscape",
        "HiJump",
        "canPreciseWalljump",
        {"obstaclesCleared": ["A", "B"]}
      ],
      "failures": [
        {
          "name": "Crumble Failure",
          "note": "Failure leaves you at 3 with a solid crumble block above."
        }
      ],
      "note": "This involves doing a quick-drop through the Crumble block, grabbing the item, and jumping back up before the crumble block reappears.",
      "devNote": "This expects that the Sidehoppers are dead. To avoid redundant requirements, they must be killed coming in."
    },
    {
      "link": [4, 1],
      "name": "Base",
      "requires": [
        {"obstaclesCleared": ["A"]}
      ],
      "devNote": "This link is only useful after Mission Impossible, which already requires the hoppers to be killed."
    },
    {
      "link": [4, 3],
      "name": "Base",
      "requires": [
        {"ammo": {"type": "Super", "count": 1}}
      ],
      "clearsObstacles": ["B"]
    }
  ]
}
