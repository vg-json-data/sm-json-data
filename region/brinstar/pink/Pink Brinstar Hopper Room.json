{
  "$schema": "../../../schema/m3-room.schema.json",
  "id": 61,
  "name": "Pink Brinstar Hopper Room",
  "area": "Brinstar",
  "subarea": "Pink",
  "playable": true,
  "roomAddress": "0x7A130",
  "roomEnvironments": [{"heated": false}],
  "nodes": [
    {
      "id": 1,
      "name": "Left Door",
      "nodeType": "door",
      "nodeSubType": "grey",
      "nodeAddress": "0x0018fb2",
      "doorEnvironments": [{"physics": "air"}],
      "leaveWithGModeSetup": [
        {"strats": [
          {
            "name": "Get Hit By Hopper",
            "notable": false,
            "requires": [],
            "note": [
              "This is possible to do without taking a second hit:",
              "Enter the room in a jump, then shoot down to open the door and land in the doorsill."
            ]
          }
        ]}
      ],
      "gModeImmobile": {
        "requires": [
          {"enemyDamage": {
            "enemy": "Sidehopper",
            "type": "contact",
            "hits": 1
          }}
        ]
      },
      "locks": [
        {
          "name": "Pink Brinstar Hoppers Left Grey Lock (to Big Pink)",
          "lockType": "killEnemies",
          "unlockStrats": [
            {
              "name": "Base",
              "notable": false,
              "requires": [
                {"obstaclesCleared": ["A"]}
              ]
            }
          ],
          "yields": ["f_ZebesAwake"]
        }
      ]
    },
    {
      "id": 2,
      "name": "Right Door",
      "nodeType": "door",
      "nodeSubType": "grey",
      "nodeAddress": "0x0018fbe",
      "doorEnvironments": [{"physics": "air"}],
      "locks": [
        {
          "name": "Pink Brinstar Hoppers Right Grey Lock (to E-Tank)",
          "lockType": "killEnemies",
          "unlockStrats": [
            {
              "name": "Base",
              "notable": false,
              "requires": [
                {"obstaclesCleared": ["A"]}
              ]
            }
          ],
          "yields": ["f_ZebesAwake"],
          "devNote": "Hoppers must be killed, possibly by going to 1 and back."
        }
      ]
    }
  ],
  "obstacles": [
    {
      "id": "A",
      "name": "Hoppers",
      "obstacleType": "enemies"
    },
    {
      "id": "B",
      "name": "Blue Gate",
      "obstacleType": "inanimate"
    },
    {
      "id": "C",
      "name": "In G-Mode - Can't Use Grapple, Open Door",
      "obstacleType": "abstract"
    }
  ],
  "enemies": [
    {
      "id": "e1",
      "groupName": "Pink Wave Gate Small Sidehoppers",
      "enemyName": "Sm. Sidehopper",
      "quantity": 2,
      "homeNodes": [1]
    },
    {
      "id": "e2",
      "groupName": "Pink Wave Gate Sidehopper",
      "enemyName": "Sidehopper",
      "quantity": 1,
      "homeNodes": [1]
    }
  ],
  "links": [
    {
      "from": 1,
      "to": [
        {"id": 1},
        {"id": 2}
      ]
    },
    {
      "from": 2,
      "to": [
        {"id": 1},
        {"id": 2}
      ]
    }
  ],
  "strats": [
    {
      "link": [1, 1],
      "name": "Leave With Runway",
      "requires": [
        {"obstaclesCleared": ["A"]}
      ],
      "exitCondition": {
        "leaveWithRunway": {
          "length": 1,
          "openEnd": 1
        }
      }
    },
    {
      "link": [1, 1],
      "name": "Power Beam Kill",
      "requires": [
        {"enemyDamage": {
          "enemy": "Sm. Sidehopper",
          "type": "contact",
          "hits": 1
        }},
        {"enemyDamage": {
          "enemy": "Sidehopper",
          "type": "contact",
          "hits": 3
        }}
      ],
      "clearsObstacles": ["A"],
      "note": [
        "This assumes you don't know you're entering this room, and take a Small Sidehopper hit quickly.",
        "The Small Sidehoppers may deliver more of the hits, but this is an assumed worst case scenario"
      ]
    },
    {
      "link": [1, 1],
      "name": "Intermediate Weapon Kill",
      "requires": [
        {"enemyDamage": {
          "enemy": "Sm. Sidehopper",
          "type": "contact",
          "hits": 1
        }},
        {"enemyDamage": {
          "enemy": "Sidehopper",
          "type": "contact",
          "hits": 1
        }},
        {"or": [
          "Spazer",
          "Wave"
        ]}
      ],
      "clearsObstacles": ["A"],
      "note": "This assumes you don't know you're entering this room, and take a Small Sidehopper hit quickly."
    },
    {
      "link": [1, 1],
      "name": "Fast Weapon Kill",
      "requires": [
        {"enemyDamage": {
          "enemy": "Sm. Sidehopper",
          "type": "contact",
          "hits": 1
        }},
        {"enemyKill": {
          "enemies": [
            ["Sidehopper", "Sm. Sidehopper", "Sm. Sidehopper"]
          ],
          "explicitWeapons": [
            "Missile",
            "Super",
            "PowerBomb",
            "ScrewAttack",
            "Plasma"
          ]
        }}
      ],
      "clearsObstacles": ["A"],
      "note": "This assumes you don't know you're entering this room, and take a Small Sidehopper hit quickly."
    },
    {
      "link": [1, 1],
      "name": "Kill on Entry (Screw Attack)",
      "requires": [
        "canPrepareForNextRoom",
        "ScrewAttack"
      ],
      "clearsObstacles": ["A"]
    },
    {
      "link": [1, 1],
      "name": "Kill on Entry (Come In With Blue Speed)",
      "entranceCondition": {
        "comeInShinecharging": {
          "length": 0,
          "openEnd": 1
        }
      },
      "requires": [
        "canPrepareForNextRoom"
      ],
      "clearsObstacles": ["A"]
    },
    {
      "link": [1, 1],
      "name": "Kill on Entry (Come In With Spark)",
      "entranceCondition": {
        "comeInWithSpark": {}
      },
      "requires": [
        "canPrepareForNextRoom",
        {"shinespark": {"frames": 24}}
      ],
      "clearsObstacles": ["A"]
    },
    {
      "link": [1, 1],
      "name": "Pink Hopper Reverse Gate Glitch",
      "notable": true,
      "requires": [
        {"obstaclesCleared": ["A"]},
        "canOffScreenSuperShot"
      ],
      "clearsObstacles": ["B"],
      "note": [
        "This strat involves shooting a Super diagonally from the correct height while flush against the left wall.",
        "Its acceleration will cause it to clip into the blue gate off-screen."
      ],
      "devNote": "The reverse gate glitch pretty much requires killing the enemies first, so it's required here."
    },
    {
      "link": [1, 1],
      "name": "G-Mode Indirect to Despawn Gate",
      "requires": [
        {"comeInWithGMode": {
          "fromNodes": [1],
          "mode": "indirect",
          "artificialMorph": false
        }}
      ],
      "clearsObstacles": ["B", "C"]
    },
    {
      "link": [1, 1],
      "name": "G-Mode Morph Indirect to Despawn Gate Power Bomb Kill",
      "requires": [
        {"comeInWithGMode": {
          "fromNodes": [1],
          "mode": "indirect",
          "artificialMorph": true
        }},
        {"enemyDamage": {
          "enemy": "Sm. Sidehopper",
          "type": "contact",
          "hits": 1
        }},
        {"ammo": {"type": "PowerBomb", "count": 1}}
      ],
      "clearsObstacles": ["A", "B", "C"],
      "note": "Kill the Sidehoppers with a Power Bomb upon entry.",
      "devNote": "A Power Bomb strat could be included to just kill the Sidehoppers, but it only saves a little energy since you'll need Wave or Supers for the gate."
    },
    {
      "link": [1, 1],
      "name": "Crystal Flash",
      "requires": [
        {"obstaclesCleared": ["A"]},
        "h_canCrystalFlash"
      ]
    },
    {
      "link": [1, 2],
      "name": "Base",
      "requires": [
        {"or": [
          "canPrepareForNextRoom",
          {"obstaclesCleared": ["A"]},
          {"enemyDamage": {
            "enemy": "Sm. Sidehopper",
            "type": "contact",
            "hits": 1
          }}
        ]},
        {"or": [
          "SpaceJump",
          "canWalljump",
          {"and": [
            "Grapple",
            {"obstaclesNotCleared": ["C"]}
          ]},
          {"and": [
            "HiJump",
            "canSpringBallJumpMidAir"
          ]}
        ]},
        {"or": [
          "Wave",
          {"obstaclesCleared": ["B"]}
        ]}
      ],
      "clearsObstacles": ["B"],
      "devNote": "The reverse gate glitch may be executed earlier from node 1 -> 1."
    },
    {
      "link": [1, 2],
      "name": "Speedy Jump Onto Grapple Block",
      "requires": [
        "HiJump",
        "canTrickyJump",
        "SpeedBooster",
        {"obstaclesCleared": ["A"]},
        {"or": [
          "Wave",
          {"obstaclesCleared": ["B"]}
        ]}
      ],
      "clearsObstacles": ["B"],
      "note": "Run from the left side to the right, then jump just before or at the end of the runway to get up onto the Grapple block."
    },
    {
      "link": [1, 2],
      "name": "Spring Ball from the Doorframe",
      "requires": [
        {"doorUnlockedAtNode": 1},
        "h_canMaxHeightSpringBallJump",
        {"obstaclesCleared": ["A"]},
        {"obstaclesNotCleared": ["C"]},
        {"or": [
          "Wave",
          {"obstaclesCleared": ["B"]}
        ]}
      ],
      "clearsObstacles": ["B"],
      "note": "Perform a very precise maximum height Spring Ball jump from the doorframe onto the Grapple block."
    },
    {
      "link": [1, 2],
      "name": "IBJ",
      "requires": [
        "h_canIBJ",
        {"obstaclesCleared": ["A"]},
        {"or": [
          "Wave",
          {"obstaclesCleared": ["B"]}
        ]}
      ],
      "clearsObstacles": ["B"],
      "devNote": [
        "IBJ requires the enemies to be killed",
        "The reverse gate glitch may be executed earlier from node 1 -> 1."
      ]
    },
    {
      "link": [1, 2],
      "name": "G-Mode Morph IBJ",
      "requires": [
        {"comeInWithGMode": {
          "fromNodes": [1],
          "mode": "any",
          "artificialMorph": true
        }},
        "h_canArtificialMorphIBJ",
        "Wave",
        {"enemyDamage": {
          "enemy": "Sm. Sidehopper",
          "type": "contact",
          "hits": 1
        }},
        {"or": [
          {"enemyDamage": {
            "enemy": "Sidehopper",
            "type": "contact",
            "hits": 3
          }},
          {"ammo": {"type": "PowerBomb", "count": 1}}
        ]}
      ],
      "clearsObstacles": ["A", "B"],
      "note": "Kill the Sidehoppers with Bombs or a Power Bomb, then IBJ up onto the Grapple block. Use Wave to get through."
    },
    {
      "link": [1, 2],
      "name": "G-Mode Morph Indirect to Despawn Gate with IBJ",
      "requires": [
        {"comeInWithGMode": {
          "fromNodes": [1],
          "mode": "indirect",
          "artificialMorph": true
        }},
        "h_canArtificialMorphIBJ",
        {"enemyDamage": {
          "enemy": "Sm. Sidehopper",
          "type": "contact",
          "hits": 1
        }},
        {"or": [
          {"enemyDamage": {
            "enemy": "Sidehopper",
            "type": "contact",
            "hits": 3
          }},
          {"ammo": {"type": "PowerBomb", "count": 1}}
        ]}
      ],
      "clearsObstacles": ["A", "B"],
      "note": "Kill the Sidehoppers with Bombs or a Power Bomb, then IBJ up onto the Grapple block."
    },
    {
      "link": [2, 1],
      "name": "Base",
      "requires": [
        {"or": [
          "canWalljump",
          "h_canFly",
          {"and": [
            "HiJump",
            "canSpringBallJumpMidAir"
          ]}
        ]}
      ],
      "clearsObstacles": ["B"]
    },
    {
      "link": [2, 1],
      "name": "Ride the Elevator",
      "requires": [
        {"or": [
          "h_canUseMorphBombs",
          "Wave"
        ]}
      ],
      "clearsObstacles": ["B"],
      "note": "The elevator can be raised by hitting below the shot block with a Bomb or Wave."
    },
    {
      "link": [2, 1],
      "name": "Elevator with Power Bombs",
      "requires": [
        "h_canUsePowerBombs"
      ],
      "clearsObstacles": ["A", "B"],
      "note": "Using a power bomb against the left wall will kill the enemies and trigger the elevator."
    },
    {
      "link": [2, 1],
      "name": "Pink Hoppers Shot Clip to Ride the Elevator",
      "notable": true,
      "requires": [
        {"or": [
          {"ammo": {"type": "Missile", "count": 1}},
          {"ammo": {"type": "Super", "count": 1}},
          {"and": [
            "Charge",
            {"or": [
              "Spazer",
              "Plasma",
              {"and": [
                "Ice",
                "canSpecialBeamAttack",
                {"ammo": {"type": "PowerBomb", "count": 1}}
              ]}
            ]}
          ]}
        ]}
      ],
      "clearsObstacles": ["B"],
      "note": [
        "The elevator can be raised by clipping a shot into the floor, shot while falling with the right amount of vertical speed.",
        "This can be done with a Missile, Super, or charged Spazer or Plasma shot or Ice SBA."
      ],
      "devNote": [
        "FIXME: Do we need leniency or another tech for this?",
        "This is only notable as a way to avoid wall jumps."
      ]
    },
    {
      "link": [2, 1],
      "name": "G-Mode Morph IBJ",
      "requires": [
        {"comeInWithGMode": {
          "fromNodes": [2],
          "mode": "any",
          "artificialMorph": true
        }},
        "h_canArtificialMorphIBJ"
      ],
      "clearsObstacles": ["B"]
    },
    {
      "link": [2, 1],
      "name": "G-Mode Morph Elevator with Power Bomb",
      "requires": [
        {"comeInWithGMode": {
          "fromNodes": [2],
          "mode": "any",
          "artificialMorph": true
        }},
        {"ammo": {"type": "PowerBomb", "count": 1}}
      ],
      "clearsObstacles": ["A", "B"],
      "note": "Using a power bomb against the left wall will kill the enemies and trigger the elevator."
    },
    {
      "link": [2, 2],
      "name": "Leave With Runway",
      "requires": [],
      "exitCondition": {
        "leaveWithRunway": {
          "length": 6,
          "openEnd": 1
        }
      }
    },
    {
      "link": [2, 2],
      "name": "Safe Kill",
      "requires": [
        {"enemyKill": {
          "enemies": [
            ["Sidehopper", "Sm. Sidehopper", "Sm. Sidehopper"]
          ],
          "explicitWeapons": ["PowerBomb", "ScrewAttack", "Wave"]
        }}
      ],
      "clearsObstacles": ["A"],
      "note": "With access to the right side of the room, it's possible to kill the enemies safely with Wave or a PB or screw attack once on the other side."
    },
    {
      "link": [2, 2],
      "name": "Crystal Flash",
      "requires": [
        "h_canCrystalFlash"
      ],
      "clearsObstacles": ["A"]
    }
  ]
}
