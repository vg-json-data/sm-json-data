{
  "$schema": "../../../schema/m3-room.schema.json",
  "id": 227,
  "name": "Metroid Room 2",
  "area": "Tourian",
  "subarea": "Main",
  "playable": true,
  "roomAddress": "0x7DB31",
  "roomEnvironments": [{"heated": false}],
  "nodes": [
    {
      "id": 1,
      "name": "Top Right Door",
      "nodeType": "door",
      "nodeSubType": "blue",
      "nodeAddress": "0x001a9c0",
      "doorEnvironments": [{"physics": "air"}],
      "leaveWithGModeSetup": [
        {"strats": [
          {
            "name": "Get Hit By Rinka",
            "notable": false,
            "requires": []
          }
        ]}
      ],
      "gModeImmobile": {
        "requires": [
          {"enemyDamage": {
            "enemy": "Rinka",
            "type": "contact",
            "hits": 1
          }}
        ]
      }
    },
    {
      "id": 2,
      "name": "Bottom Right Door",
      "nodeType": "door",
      "nodeSubType": "grey",
      "nodeAddress": "0x001a9cc",
      "doorEnvironments": [{"physics": "air"}],
      "leaveWithGModeSetup": [
        {"strats": [
          {
            "name": "Get Hit By Rinka",
            "notable": false,
            "requires": [
              {"or": [
                "canMetroidAvoid",
                "canUseFrozenEnemies",
                "ScrewAttack",
                "f_KilledMetroidRoom2"
              ]}
            ],
            "note": "If the Metroids are alive, lure them off screen."
          }
        ]},
        {
          "strats": [
            {
              "name": "Get Hit By Metroid",
              "notable": false,
              "requires": [
                {"not": "f_KilledMetroidRoom2"},
                "canRiskPermanentLossOfAccess"
              ]
            }
          ],
          "knockback": false
        }
      ],
      "gModeImmobile": {
        "requires": [
          {"enemyDamage": {
            "enemy": "Rinka",
            "type": "contact",
            "hits": 1
          }},
          {"or": [
            "f_KilledMetroidRoom2",
            {"metroidFrames": 120}
          ]}
        ],
        "note": "If alive, the Metroids do 90 damage before the Rinka hits."
      },
      "locks": [
        {
          "name": "Metroid Room 2 Grey Lock (to Metroid Room 3)",
          "lockType": "killEnemies",
          "unlockStrats": [
            {
              "name": "Base",
              "notable": false,
              "requires": [
                {"obstaclesCleared": ["A"]}
              ]
            }
          ],
          "yields": ["f_KilledMetroidRoom2", "f_ZebesAwake"]
        }
      ]
    }
  ],
  "obstacles": [
    {
      "id": "A",
      "name": "Two Metroids",
      "obstacleType": "enemies"
    }
  ],
  "enemies": [
    {
      "id": "e1",
      "groupName": "Metroid Room 2 Metroids",
      "enemyName": "Metroid",
      "quantity": 2,
      "homeNodes": [2],
      "stopSpawn": ["f_KilledMetroidRoom2"]
    },
    {
      "id": "e2",
      "groupName": "Metroid Room 2 Rinkas",
      "enemyName": "Rinka",
      "quantity": 4,
      "homeNodes": [1, 2]
    }
  ],
  "links": [
    {
      "from": 1,
      "to": [
        {"id": 1},
        {"id": 2}
      ]
    },
    {
      "from": 2,
      "to": [
        {"id": 1},
        {"id": 2}
      ]
    }
  ],
  "strats": [
    {
      "link": [1, 1],
      "name": "Leave with Runway",
      "requires": [],
      "exitCondition": {
        "leaveWithRunway": {
          "length": 3,
          "openEnd": 1
        }
      }
    },
    {
      "link": [1, 2],
      "name": "Already Cleared",
      "requires": [
        "f_KilledMetroidRoom2"
      ],
      "clearsObstacles": ["A"]
    },
    {
      "link": [1, 2],
      "name": "Ammo Kill",
      "requires": [
        "Ice",
        {"enemyKill": {
          "enemies": [["Metroid", "Metroid"]],
          "explicitWeapons": ["Super", "Missile"]
        }}
      ],
      "clearsObstacles": ["A"]
    },
    {
      "link": [1, 2],
      "name": "Tank and PB Kill",
      "requires": [
        {"enemyKill": {
          "enemies": [["Metroid", "Metroid"]],
          "excludedWeapons": ["Super", "Missile"]
        }},
        {"metroidFrames": 96}
      ],
      "clearsObstacles": ["A"]
    },
    {
      "link": [1, 2],
      "name": "Metroid Room 2 PB Dodge Kill",
      "requires": [
        {"enemyKill": {
          "enemies": [["Metroid", "Metroid"]],
          "excludedWeapons": ["Super", "Missile"]
        }},
        {"or": [
          "canMetroidAvoid",
          "canCameraManip"
        ]}
      ],
      "clearsObstacles": ["A"],
      "note": "An easy way is once Samus is on the top platform, jump and aim down to lower the camera, then place 3 PBs."
    },
    {
      "link": [1, 2],
      "name": "Ice Evade",
      "requires": [
        "Ice"
      ]
    },
    {
      "link": [1, 2],
      "name": "Screw Evade",
      "requires": [
        "canDodgeWhileShooting",
        {"or": [
          "ScrewAttack",
          "canPseudoScrew"
        ]}
      ],
      "note": [
        "Use ScrewAttack or a PseudoScrew to prevent Metroids from attaching to Samus."
      ]
    },
    {
      "link": [1, 2],
      "name": "Harder Evade",
      "requires": [
        "canMetroidAvoid"
      ]
    },
    {
      "link": [1, 2],
      "name": "Tank the Damage",
      "requires": [
        {"metroidFrames": 80}
      ]
    },
    {
      "link": [2, 1],
      "name": "Already Cleared",
      "requires": [
        "f_KilledMetroidRoom2"
      ],
      "clearsObstacles": ["A"]
    },
    {
      "link": [2, 1],
      "name": "Ammo Kill",
      "requires": [
        "Ice",
        {"enemyKill": {
          "enemies": [["Metroid", "Metroid"]],
          "explicitWeapons": ["Super", "Missile"]
        }}
      ],
      "clearsObstacles": ["A"]
    },
    {
      "link": [2, 1],
      "name": "Tank and PB Kill",
      "requires": [
        {"enemyKill": {
          "enemies": [["Metroid", "Metroid"]],
          "excludedWeapons": ["Super", "Missile"]
        }},
        {"metroidFrames": 96}
      ],
      "clearsObstacles": ["A"]
    },
    {
      "link": [2, 1],
      "name": "Metroid Room 2 PB Dodge Kill (Bottom to Top)",
      "notable": true,
      "requires": [
        {"enemyKill": {
          "enemies": [["Metroid", "Metroid"]],
          "excludedWeapons": ["Super", "Missile"]
        }},
        "canMetroidAvoid"
      ],
      "clearsObstacles": ["A"],
      "note": "Kill the two Metroids with Power Bombs while avoiding damage."
    },
    {
      "link": [2, 1],
      "name": "Ice Evade",
      "requires": [
        "Ice"
      ]
    },
    {
      "link": [2, 1],
      "name": "Screw Evade",
      "requires": [
        {"or": [
          {"and": [
            "ScrewAttack",
            "canDodgeWhileShooting"
          ]},
          {"and": [
            "canPseudoScrew",
            "canPrepareForNextRoom",
            "canDodgeWhileShooting"
          ]}
        ]}
      ],
      "note": "Use ScrewAttack or a PseudoScrew to prevent Metroids from attaching to Samus."
    },
    {
      "link": [2, 1],
      "name": "Metroid Room 2 Bottom Door Metroid Avoid",
      "notable": true,
      "requires": [
        "canMetroidAvoid"
      ],
      "note": [
        "Buffer a spinjump towards the door to jump over the top metroid and land on the middle platform.",
        "Metroids can knocked with Beam shots to clear a path."
      ]
    },
    {
      "link": [2, 1],
      "name": "Tank the Damage",
      "requires": [
        {"metroidFrames": 80}
      ]
    },
    {
      "link": [2, 1],
      "name": "Very Deep Stuck X-Ray Climb With Immobile",
      "entranceCondition": {
        "comeInWithGMode": {
          "mode": "direct",
          "morphed": false,
          "mobility": "immobile"
        }
      },
      "requires": [
        "f_KilledMetroidRoom2",
        {"enemyDamage": {
          "enemy": "Rinka",
          "type": "contact",
          "hits": 1
        }},
        "canXRayClimb"
      ],
      "bypassesDoorShell": true,
      "note": [
        "Enter immobile with G-mode direct, with the Metroids having been killed previously.",
        "Take a Rinka hit to regain mobility.",
        "Back up to between 1 and 6 pixels from the door transition, and activate X-ray to get very deep stuck in the door.",
        "Climb up 1 screen, moving quickly to minimize Rinka damage.",
        "Perform a turnaround buffered spin-jump away from the door to trigger the transition, bypassing any lock on the door."
      ],
      "devNote": [
        "The 'immobile' requirement in the entranceCondition is not necessary but is included for clarity.",
        "Without coming in immobile, it would not be possible to have enough energy to survive the Rinka hit.",
        "The enemyDamage in this strat is for a second Rinka hit while climbing.",
        "The first Rinka hit is included in the gModeImmobile requirement."
      ]
    },
    {
      "link": [2, 1],
      "name": "Very Deep Stuck X-Ray Climb With Ice",
      "entranceCondition": {
        "comeInWithGMode": {
          "mode": "direct",
          "morphed": false
        }
      },
      "requires": [
        "Ice",
        "canXRayClimb"
      ],
      "bypassesDoorShell": true,
      "note": [
        "Enter with G-mode direct, and quickly freeze the Metroids (if still alive) and Rinkas.",
        "Back up to between 1 and 6 pixels from the door transition, and activate X-ray to get very deep stuck in the door.",
        "Climb up 1 screen, moving quickly to avoid Rinka damage.",
        "Perform a turnaround buffered spin-jump away from the door to trigger the transition, bypassing any lock on the door."
      ]
    },
    {
      "link": [2, 1],
      "name": "Very Deep Stuck X-Ray Climb With Crystal Flash",
      "entranceCondition": {
        "comeInWithGMode": {
          "mode": "direct",
          "morphed": false
        }
      },
      "requires": [
        "h_canCrystalFlash",
        {"autoReserveTrigger": {}},
        "canXRayClimb",
        {"enemyDamage": {
          "enemy": "Rinka",
          "type": "contact",
          "hits": 1
        }}
      ],
      "bypassesDoorShell": true,
      "note": [
        "Enter with G-mode direct, using artificial morph to avoid the Metroids if they are still alive.",
        "Go to the top of the room and Crystal Flash, with the Metroids stuck below (if alive).",
        "The Crystal Flash will leave behind a light orb, which can be used to kill the Metroids.",
        "Use the Rinkas to damage down.",
        "For the final hit that will trigger auto-reserves, stand in the open doorway between 1 and 6 pixels from the transition.",
        "The auto reserve trigger will cancel G-mode and close the door on top of Samus.",
        "Climb up 1 screen, moving quickly to minimize Rinka damage.",
        "Perform a turnaround buffered spin-jump away from the door to trigger the transition, bypassing any lock on the door."
      ]
    },
    {
      "link": [2, 2],
      "name": "Leave with Runway",
      "requires": [
        {"or": [
          "f_KilledMetroidRoom2",
          "Ice",
          {"and": [
            {"enemyDamage": {
              "enemy": "Rinka",
              "type": "contact",
              "hits": 1
            }},
            {"metroidFrames": 22}
          ]}
        ]}
      ],
      "exitCondition": {
        "leaveWithRunway": {
          "length": 3,
          "openEnd": 1
        }
      },
      "devNote": "FIXME: Is it worth adding a method with avoiding the Metroids?"
    },
    {
      "link": [2, 2],
      "name": "Crystal Flash",
      "requires": [
        {"obstaclesCleared": ["A"]},
        "h_canCrystalFlash",
        {"enemyDamage": {
          "enemy": "Rinka",
          "type": "contact",
          "hits": 1
        }}
      ],
      "note": [
        "To avoid heavy Rinka damage, you must perform the Crystal Flash on a specific tile: on the third floor tile from the left wall.",
        "Lay the Power Bomb immediately after destroying both Rinkas."
      ]
    }
  ]
}
