{
  "$schema": "../../../schema/m3-room.schema.json",
  "id": 170,
  "name": "Glass Tunnel",
  "area": "Maridia",
  "subarea": "Outer",
  "playable": true,
  "roomAddress": "0x7CEFB",
  "roomEnvironments": [{"heated": false}],
  "nodes": [
    {
      "id": 1,
      "name": "Left Doorway",
      "nodeType": "door",
      "nodeSubType": "doorway",
      "nodeAddress": "0x001a33c",
      "doorEnvironments": [
        {
          "physics": "water",
          "note": "It has normal physics before the tube is broken, but that can be lost forever."
        }
      ],
      "leaveWithGMode": [
        {
          "leavesWithArtificialMorph": false,
          "strats": [
            {
              "name": "Carry G-Mode Through Tube (Right to Left)",
              "notable": false,
              "requires": [
                {"comeInWithGMode": {
                  "fromNodes": [3],
                  "artificialMorph": false,
                  "mode": "any"
                }}
              ]
            },
            {
              "name": "Carry G-Mode Through Tube (Bottom to Left)",
              "notable": false,
              "requires": [
                {"comeInWithGMode": {
                  "fromNodes": [2],
                  "artificialMorph": false,
                  "mode": "any"
                }},
                "f_MaridiaTubeBroken"
              ]
            },
            {
              "name": "Carry G-Mode Through Tube (Top to Left)",
              "notable": false,
              "requires": [
                {"comeInWithGMode": {
                  "fromNodes": [4],
                  "artificialMorph": false,
                  "mode": "any"
                }},
                "f_MaridiaTubeBroken",
                {"or": [
                  "Gravity",
                  "HiJump",
                  "canSpringBallJumpMidAir"
                ]}
              ]
            }
          ]
        },
        {
          "leavesWithArtificialMorph": true,
          "strats": [
            {
              "name": "Carry G-Mode Morph Through Tube (Right to Left)",
              "notable": false,
              "requires": [
                {"comeInWithGMode": {
                  "fromNodes": [3],
                  "artificialMorph": true,
                  "mode": "any"
                }},
                {"or": [
                  "Morph",
                  "SpringBall",
                  {"and": [
                    "Gravity",
                    "h_canArtificialMorphIBJ"
                  ]},
                  {"and": [
                    "Gravity",
                    "h_canArtificialMorphBombHorizontally",
                    {"or": [
                      "Bombs",
                      {"ammo": {"type": "PowerBomb", "count": 1}}
                    ]}
                  ]},
                  {"and": [
                    {"not": "f_MaridiaTubeBroken"},
                    "canRiskPermanentLossOfAccess"
                  ]}
                ]}
              ],
              "devNote": [
                "Bomb jumping across the broken tube uses a second bomb to climb up to the tube.",
                "FIXME: Moving before the bomb explodes gives enough momentum to only need one power bomb."
              ]
            },
            {
              "name": "Carry G-Mode Morph Through Tube (Bottom to Left)",
              "notable": false,
              "requires": [
                {"comeInWithGMode": {
                  "fromNodes": [2],
                  "artificialMorph": true,
                  "mode": "any"
                }},
                "f_MaridiaTubeBroken",
                {"or": [
                  {"and": [
                    "Gravity",
                    "h_canArtificialMorphMovement"
                  ]},
                  {"and": [
                    "canSuitlessMaridia",
                    "SpringBall",
                    "HiJump"
                  ]}
                ]}
              ]
            },
            {
              "name": "Carry G-Mode Morph Through Tube (Top to Left)",
              "notable": false,
              "requires": [
                {"comeInWithGMode": {
                  "fromNodes": [4],
                  "artificialMorph": true,
                  "mode": "any"
                }},
                "f_MaridiaTubeBroken",
                {"or": [
                  "Gravity",
                  "HiJump"
                ]}
              ]
            }
          ]
        }
      ]
    },
    {
      "id": 2,
      "name": "Bottom Right Door",
      "nodeType": "door",
      "nodeSubType": "red",
      "nodeAddress": "0x001a354",
      "doorEnvironments": [
        {
          "physics": "water",
          "note": "It has normal physics before the tube is broken, but that can be lost forever."
        }
      ],
      "locks": [
        {
          "name": "Glass Tunnel Red Lock (to Save)",
          "lockType": "coloredDoor",
          "unlockStrats": [
            {
              "name": "Base",
              "notable": false,
              "requires": [
                "h_canOpenRedDoors"
              ]
            }
          ]
        }
      ]
    },
    {
      "id": 3,
      "name": "Top Right Doorway",
      "nodeType": "door",
      "nodeSubType": "doorway",
      "nodeAddress": "0x001a348",
      "doorEnvironments": [
        {
          "physics": "water",
          "note": "It has normal physics before the tube is broken, but that can be lost forever."
        }
      ],
      "leaveWithGMode": [
        {
          "leavesWithArtificialMorph": false,
          "strats": [
            {
              "name": "Carry G-Mode Through Tube (Left to Right)",
              "notable": false,
              "requires": [
                {"comeInWithGMode": {
                  "fromNodes": [1],
                  "artificialMorph": false,
                  "mode": "any"
                }}
              ]
            },
            {
              "name": "Carry G-Mode Through Tube (Bottom to Right)",
              "notable": false,
              "requires": [
                {"comeInWithGMode": {
                  "fromNodes": [2],
                  "artificialMorph": false,
                  "mode": "any"
                }},
                "f_MaridiaTubeBroken"
              ]
            },
            {
              "name": "Carry G-Mode Through Tube (Top to Right)",
              "notable": false,
              "requires": [
                {"comeInWithGMode": {
                  "fromNodes": [4],
                  "artificialMorph": false,
                  "mode": "any"
                }},
                "f_MaridiaTubeBroken",
                {"or": [
                  "Gravity",
                  "HiJump",
                  "canSpringBallJumpMidAir"
                ]}
              ]
            }
          ]
        },
        {
          "leavesWithArtificialMorph": true,
          "strats": [
            {
              "name": "Carry G-Mode Morph Through Tube (Left to Right)",
              "notable": false,
              "requires": [
                {"comeInWithGMode": {
                  "fromNodes": [1],
                  "artificialMorph": true,
                  "mode": "any"
                }},
                {"or": [
                  "Morph",
                  "SpringBall",
                  {"and": [
                    "Gravity",
                    "h_canArtificialMorphIBJ"
                  ]},
                  {"and": [
                    "Gravity",
                    "h_canArtificialMorphBombHorizontally",
                    {"or": [
                      "Bombs",
                      {"ammo": {"type": "PowerBomb", "count": 1}}
                    ]}
                  ]},
                  {"and": [
                    {"not": "f_MaridiaTubeBroken"},
                    "canRiskPermanentLossOfAccess"
                  ]}
                ]}
              ],
              "devNote": [
                "Bomb jumping across the broken tube uses a second bomb to climb up to the tube.",
                "FIXME: Moving before the bomb explodes gives enough momentum to only need one power bomb."
              ]
            },
            {
              "name": "Carry G-Mode Morph Through Tube (Bottom to Right)",
              "notable": false,
              "requires": [
                {"comeInWithGMode": {
                  "fromNodes": [2],
                  "artificialMorph": true,
                  "mode": "any"
                }},
                "f_MaridiaTubeBroken",
                {"or": [
                  {"and": [
                    "Gravity",
                    "h_canArtificialMorphMovement"
                  ]},
                  {"and": [
                    "canSuitlessMaridia",
                    "SpringBall",
                    "HiJump"
                  ]}
                ]}
              ]
            },
            {
              "name": "Carry G-Mode Morph Through Tube (Top to Right)",
              "notable": false,
              "requires": [
                {"comeInWithGMode": {
                  "fromNodes": [4],
                  "artificialMorph": true,
                  "mode": "any"
                }},
                "f_MaridiaTubeBroken",
                {"or": [
                  "Gravity",
                  "HiJump"
                ]}
              ]
            }
          ]
        }
      ]
    },
    {
      "id": 4,
      "name": "Top Door",
      "nodeType": "door",
      "nodeSubType": "blue",
      "nodeAddress": "0x001a330",
      "doorEnvironments": [
        {
          "physics": "water",
          "note": "It has normal physics before the tube is broken, but that can be lost forever."
        }
      ],
      "spawnAt": 6
    },
    {
      "id": 5,
      "name": "Inside Maridia Tube",
      "nodeType": "event",
      "nodeSubType": "flag",
      "locks": [
        {
          "name": "Inside Maridia Tube Event Lock",
          "lockType": "triggeredEvent",
          "unlockStrats": [
            {
              "name": "Base",
              "notable": false,
              "requires": [
                "h_canUsePowerBombs"
              ]
            },
            {
              "name": "G-Mode Morph PB",
              "notable": false,
              "requires": [
                {"comeInWithGMode": {
                  "fromNodes": [1, 3],
                  "mode": "any",
                  "artificialMorph": true
                }},
                {"ammo": {"type": "PowerBomb", "count": 1}}
              ]
            }
          ]
        }
      ],
      "yields": ["f_MaridiaTubeBroken"],
      "note": "Represents the inside of the tube; unlocking this node breaks the tube"
    },
    {
      "id": 6,
      "name": "Above Maridia Tube",
      "nodeType": "event",
      "nodeSubType": "flag",
      "locks": [
        {
          "name": "Above Maridia Tube Event Lock",
          "lockType": "triggeredEvent",
          "unlockStrats": [
            {
              "name": "Base",
              "notable": false,
              "requires": [
                "h_canUsePowerBombs"
              ]
            },
            {
              "name": "G-Mode Morph PB",
              "notable": false,
              "requires": [
                {"comeInWithGMode": {
                  "fromNodes": [4],
                  "mode": "any",
                  "artificialMorph": true
                }},
                {"ammo": {"type": "PowerBomb", "count": 1}}
              ],
              "devNote": "Be sure not to overload PLMs with the camera scroll blocks which are next to the tube. It is possible to exit g-mode before the PB goes off to be safe."
            }
          ]
        }
      ],
      "yields": ["f_MaridiaTubeBroken"],
      "note": "Represents the area just above the tube; unlocking this node breaks the tube"
    },
    {
      "id": 7,
      "name": "Below Maridia Tube",
      "nodeType": "event",
      "nodeSubType": "flag",
      "locks": [
        {
          "name": "Below Maridia Tube Event Lock",
          "lockType": "triggeredEvent",
          "unlockStrats": [
            {
              "name": "Base",
              "notable": false,
              "requires": [
                "h_canUsePowerBombs"
              ]
            },
            {
              "name": "G-Mode Morph PB",
              "notable": false,
              "requires": [
                {"comeInWithGMode": {
                  "fromNodes": [2],
                  "mode": "any",
                  "artificialMorph": true
                }},
                {"ammo": {"type": "PowerBomb", "count": 1}},
                "h_canArtificialMorphMovement"
              ]
            }
          ]
        }
      ],
      "yields": ["f_MaridiaTubeBroken"],
      "note": "Represents the area just below the tube; unlocking this node breaks the tube"
    },
    {
      "id": 8,
      "name": "Maridia Tube Gravity Jump",
      "nodeType": "event",
      "nodeSubType": "flag",
      "locks": [
        {
          "name": "Maridia Tube Gravity Jump Event Lock",
          "lockType": "triggeredEvent",
          "unlockStrats": [
            {
              "name": "Base",
              "notable": false,
              "requires": [],
              "note": "This requires nothing, as its requirements are instead needed to get to this node."
            }
          ]
        }
      ],
      "yields": ["f_MaridiaTubeBroken"],
      "note": "This node is for triggering a suitless gravity jump while breaking the tube, which can only be done once."
    }
  ],
  "enemies": [],
  "reusableRoomwideNotable": [
    {
      "name": "Glass Tunnel Maridia Tube Clip",
      "note": [
        "Clip into the Maridia Tube from above without needing to break the tube.",
        "This can be done with morph by unmorphing under the sloped tiles on the right, or with canTunnelCrawl by wedging Samus under them with a precise low jump and then performing a tunnel crawl."
      ]
    }
  ],
  "links": [
    {
      "from": 1,
      "to": [
        {"id": 1},
        {"id": 3},
        {
          "id": 4,
          "note": "This link is only for the cross room jump. Other strats should go 1 -> 5 -> 6 -> 8 -> 4."
        },
        {"id": 5}
      ]
    },
    {
      "from": 2,
      "to": [
        {"id": 2},
        {"id": 3},
        {
          "id": 4,
          "note": "This link is only for the cross room jump. Other strats should go 2 -> 7 -> 5 -> 6 -> 8 -> 4."
        },
        {"id": 7}
      ]
    },
    {
      "from": 3,
      "to": [
        {"id": 1},
        {"id": 3},
        {
          "id": 4,
          "note": "This link is only for the cross room jump. Other strats should go 3 -> 5 -> 6 -> 8 -> 4."
        },
        {"id": 5}
      ]
    },
    {
      "from": 4,
      "to": [
        {"id": 6}
      ]
    },
    {
      "from": 5,
      "to": [
        {"id": 1},
        {"id": 3},
        {"id": 6},
        {"id": 7},
        {
          "id": 8,
          "note": "While breaking the tube, gravity jump up to the top door. This can only be attempted once.",
          "devNote": "This link is only used for getting a gravity jump through the top door while breaking the Maridia Tube."
        }
      ]
    },
    {
      "from": 6,
      "to": [
        {"id": 4},
        {"id": 5}
      ]
    },
    {
      "from": 7,
      "to": [
        {"id": 2},
        {"id": 5}
      ]
    },
    {
      "from": 8,
      "to": [
        {"id": 4}
      ]
    }
  ],
  "strats": [
    {
      "link": [1, 1],
      "name": "Leave with Runway",
      "requires": [],
      "exitCondition": {
        "leaveWithRunway": {
          "length": 3,
          "openEnd": 1
        }
      }
    },
    {
      "link": [1, 1],
      "name": "Crystal Flash",
      "requires": [
        "h_canCrystalFlash"
      ]
    },
    {
      "link": [1, 1],
      "name": "Leave with Runway, Tube Not Broken",
      "requires": [
        {"not": "f_MaridiaTubeBroken"},
        "canRiskPermanentLossOfAccess"
      ],
      "exitCondition": {
        "leaveWithRunway": {
          "length": 14,
          "openEnd": 0
        }
      },
      "devNote": "FIXME: Needs a way to represent that this runway has an 'air' environment."
    },
    {
      "link": [1, 3],
      "name": "Shinespark Through Room",
      "entranceCondition": {
        "comeInWithSpark": {}
      },
      "requires": [
        {"or": [
          {"shinespark": {"frames": 24}},
          {"and": [
            "Gravity",
            {"shinespark": {"frames": 21}}
          ]},
          {"and": [
            {"not": "f_MaridiaTubeBroken"},
            "canRiskPermanentLossOfAccess",
            {"shinespark": {"frames": 21}}
          ]}
        ]}
      ],
      "exitCondition": {
        "leaveWithSpark": {}
      }
    },
    {
      "link": [1, 3],
      "name": "Come In Shinecharging, Leave Shinecharged, Tube Not Broken",
      "entranceCondition": {
        "comeInShinecharging": {
          "length": 13,
          "openEnd": 0
        }
      },
      "requires": [
        {"not": "f_MaridiaTubeBroken"},
        "canRiskPermanentLossOfAccess"
      ],
      "exitCondition": {
        "leaveShinecharged": {
          "framesRemaining": 179
        }
      }
    },
    {
      "link": [1, 4],
      "name": "Cross Room Jump",
      "entranceCondition": {
        "comeInJumping": {
          "speedBooster": false,
          "minTiles": 0.4375
        }
      },
      "requires": [
        "f_MaridiaTubeBroken",
        "canCrossRoomJumpIntoWater"
      ],
      "note": [
        "Only requires a runway of 1 tile in the adjacent room.",
        "This strat is slightly easier on the right side at low run speeds, but the same otherwise."
      ]
    },
    {
      "link": [1, 5],
      "name": "Base",
      "requires": []
    },
    {
      "link": [2, 2],
      "name": "Leave with Runway",
      "requires": [],
      "exitCondition": {
        "leaveWithRunway": {
          "length": 5,
          "openEnd": 1
        }
      }
    },
    {
      "link": [2, 2],
      "name": "Leave with Runway, Tube Not Broken",
      "requires": [
        {"not": "f_MaridiaTubeBroken"},
        "canRiskPermanentLossOfAccess"
      ],
      "exitCondition": {
        "leaveWithRunway": {
          "length": 5,
          "openEnd": 1
        }
      },
      "devNote": "FIXME: Needs a way to represent that this runway has an 'air' environment."
    },
    {
      "link": [2, 3],
      "name": "G-Mode Deep Stuck X-Ray Climb",
      "requires": [
        {"comeInWithGMode": {
          "fromNodes": [2],
          "mode": "direct",
          "artificialMorph": false
        }},
        "canXRayClimb"
      ],
      "note": "Climb up 1 screen."
    },
    {
      "link": [2, 3],
      "name": "Shinespark Deep Stuck X-Ray Climb",
      "entranceCondition": {
        "comeInShinecharged": {
          "framesRequired": 1
        }
      },
      "requires": [
        {"shinespark": {"frames": 1, "excessFrames": 1}},
        "canShinesparkDeepStuck",
        "canXRayClimb"
      ],
      "note": "Climb up 1 screen."
    },
    {
      "link": [2, 4],
      "name": "Cross Room Jump with Speedbooster",
      "entranceCondition": {
        "comeInJumping": {
          "speedBooster": true,
          "minTiles": 18
        }
      },
      "requires": [
        "f_MaridiaTubeBroken",
        "canCrossRoomJumpIntoWater",
        "canMomentumConservingTurnaround"
      ],
      "note": [
        "Requires a runway of 18 tiles in the adjacent room.",
        "Ride up the right wall just above the doorway, then turnaround before and after hitting the platform below the tube."
      ]
    },
    {
      "link": [2, 7],
      "name": "Base",
      "requires": []
    },
    {
      "link": [3, 1],
      "name": "Shinespark Through Room",
      "entranceCondition": {
        "comeInWithSpark": {}
      },
      "requires": [
        {"or": [
          {"shinespark": {"frames": 24}},
          {"and": [
            "Gravity",
            {"shinespark": {"frames": 21}}
          ]},
          {"and": [
            {"not": "f_MaridiaTubeBroken"},
            "canRiskPermanentLossOfAccess",
            {"shinespark": {"frames": 21}}
          ]}
        ]}
      ],
      "exitCondition": {
        "leaveWithSpark": {}
      }
    },
    {
      "link": [3, 1],
      "name": "Come In Shinecharging, Leave Shinecharged, Tube Not Broken",
      "entranceCondition": {
        "comeInShinecharging": {
          "length": 13,
          "openEnd": 0
        }
      },
      "requires": [
        {"not": "f_MaridiaTubeBroken"},
        "canRiskPermanentLossOfAccess"
      ],
      "exitCondition": {
        "leaveShinecharged": {
          "framesRemaining": 179
        }
      }
    },
    {
      "link": [3, 3],
      "name": "Leave with Runway",
      "requires": [],
      "exitCondition": {
        "leaveWithRunway": {
          "length": 3,
          "openEnd": 1
        }
      }
    },
    {
      "link": [3, 3],
      "name": "Leave with Runway, Tube Not Broken",
      "requires": [
        {"not": "f_MaridiaTubeBroken"},
        "canRiskPermanentLossOfAccess"
      ],
      "exitCondition": {
        "leaveWithRunway": {
          "length": 14,
          "openEnd": 0
        }
      },
      "devNote": "FIXME: Needs a way to represent that this runway has an 'air' environment."
    },
    {
      "link": [3, 4],
      "name": "Cross Room Jump",
      "entranceCondition": {
        "comeInJumping": {
          "speedBooster": false,
          "minTiles": 0.4375
        }
      },
      "requires": [
        "f_MaridiaTubeBroken",
        "canCrossRoomJumpIntoWater"
      ],
      "note": [
        "Only requires a runway of one tile in the adjacent room.",
        "This strat is slightly easier on the right side at low run speeds, but the same otherwise."
      ]
    },
    {
      "link": [3, 5],
      "name": "Base",
      "requires": []
    },
    {
      "link": [4, 6],
      "name": "Base",
      "requires": []
    },
    {
      "link": [5, 1],
      "name": "Base",
      "requires": []
    },
    {
      "link": [5, 3],
      "name": "Base",
      "requires": []
    },
    {
      "link": [5, 6],
      "name": "Base",
      "requires": [
        "f_MaridiaTubeBroken",
        "Gravity"
      ]
    },
    {
      "link": [5, 6],
      "name": "Suitless Base",
      "requires": [
        "f_MaridiaTubeBroken",
        "HiJump"
      ],
      "note": "Doesn't require canSuitlessMaridia because there is no risk, nor anything tricky whatsoever."
    },
    {
      "link": [5, 6],
      "name": "Suitless",
      "requires": [
        "f_MaridiaTubeBroken",
        "canSuitlessMaridia",
        "canSpringBallJumpMidAir"
      ]
    },
    {
      "link": [5, 7],
      "name": "Base",
      "requires": [
        "f_MaridiaTubeBroken"
      ]
    },
    {
      "link": [5, 8],
      "name": "Breaking the Maridia Tube Gravity Jump",
      "notable": true,
      "requires": [
        {"not": "f_MaridiaTubeBroken"},
        "canRiskPermanentLossOfAccess",
        "h_canUsePowerBombs",
        "canSuitlessMaridia",
        "canTrickyJump"
      ],
      "note": [
        "Jump as the first action after breaking the tube to gravity jump to the top of the room.",
        "Open the door and go through it during the ascent. This can only be attempted once."
      ]
    },
    {
      "link": [5, 8],
      "name": "G-Mode Morph Breaking the Maridia Tube Gravity Jump",
      "notable": true,
      "requires": [
        {"comeInWithGMode": {
          "fromNodes": [1, 3],
          "mode": "any",
          "artificialMorph": true
        }},
        {"ammo": {"type": "PowerBomb", "count": 1}},
        {"not": "f_MaridiaTubeBroken"},
        "canRiskPermanentLossOfAccess",
        "canSuitlessMaridia",
        "canTrickyJump"
      ],
      "note": [
        "Jump as the first action after breaking the tube to gravity jump to the top of the room.",
        "The tube will break when exiting G-Mode or when the Power Bomb finishes detonating, whichever is later.",
        "Open the door and go through it during the ascent. This can only be attempted once."
      ]
    },
    {
      "link": [6, 4],
      "name": "Base",
      "requires": [
        "Gravity"
      ]
    },
    {
      "link": [6, 4],
      "name": "Suitless Base",
      "requires": [
        "HiJump"
      ],
      "note": "Doesn't require canSuitlessMaridia because there is no risk, nor anything tricky whatsoever."
    },
    {
      "link": [6, 4],
      "name": "Suitless",
      "requires": [
        "canSuitlessMaridia",
        "canSpringBallJumpMidAir"
      ]
    },
    {
      "link": [6, 4],
      "name": "Tube Intact",
      "requires": [
        {"not": "f_MaridiaTubeBroken"},
        "canRiskPermanentLossOfAccess"
      ],
      "note": "Until the tube is broken there is no water in this room."
    },
    {
      "link": [6, 5],
      "name": "Base",
      "requires": [
        "f_MaridiaTubeBroken"
      ]
    },
    {
      "link": [6, 5],
      "name": "Maridia Tube Unmorph Clip",
      "notable": true,
      "requires": [
        "Morph"
      ],
      "reusableRoomwideNotable": "Glass Tunnel Maridia Tube Clip",
      "note": "Unmorph once fully underneath the rightside slope to clip."
    },
    {
      "link": [6, 5],
      "name": "Maridia Tube Standing Clip",
      "notable": true,
      "requires": [
        "canTunnelCrawl"
      ],
      "reusableRoomwideNotable": "Glass Tunnel Maridia Tube Clip",
      "note": [
        "Wedge Samus under the right side slope with either a very clean low jump or tunnel crawl movements.",
        "Once deep enough, the clip will happen automatically."
      ]
    },
    {
      "link": [7, 2],
      "name": "Base",
      "requires": []
    },
    {
      "link": [7, 5],
      "name": "Base",
      "requires": [
        "f_MaridiaTubeBroken"
      ]
    },
    {
      "link": [8, 4],
      "name": "Base",
      "requires": [
        "f_MaridiaTubeBroken"
      ]
    }
  ]
}
