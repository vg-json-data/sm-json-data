{
  "$schema": "../../../schema/m3-room.schema.json",
  "id": 201,
  "name": "Crab Hole",
  "area": "Maridia",
  "subarea": "Outer",
  "playable": true,
  "roomAddress": "0x7D21C",
  "roomEnvironments": [{"heated": false}],
  "nodes": [
    {
      "id": 1,
      "name": "Top Left Doorway",
      "nodeType": "door",
      "nodeSubType": "doorway",
      "nodeAddress": "0x001a4f8",
      "doorEnvironments": [{"physics": "water"}],
      "leaveWithGMode": [
        {
          "leavesWithArtificialMorph": false,
          "strats": [
            {
              "name": "Carry G-Mode Through Tube (Right to Left)",
              "notable": false,
              "requires": [
                {"comeInWithGMode": {
                  "fromNodes": [4],
                  "artificialMorph": false,
                  "mode": "any"
                }}
              ]
            },
            {
              "name": "Carry G-Mode Through Tube (Bottom to Left)",
              "notable": false,
              "requires": [
                {"comeInWithGMode": {
                  "fromNodes": [2, 3],
                  "artificialMorph": false,
                  "mode": "any"
                }},
                "Morph",
                {"or": [
                  "Gravity",
                  {"and": [
                    "canSuitlessMaridia",
                    "canUseFrozenEnemies",
                    "HiJump",
                    "h_canCrouchJumpDownGrab"
                  ]},
                  {"and": [
                    "canSuitlessMaridia",
                    {"ammo": {"type": "Super", "count": 1}},
                    "canTrickyUseFrozenEnemies",
                    "canOffScreenMovement"
                  ]},
                  {"and": [
                    "canSuitlessMaridia",
                    "canTrickyJump",
                    "canSpringBallJumpMidAir",
                    "canTrickyUseFrozenEnemies",
                    "canOffScreenMovement"
                  ]}
                ]}
              ],
              "note": "There is some off screen movement. Note that the crabs are global and will continue to move regardless of Samus' position.",
              "devNote": "There are many ways to get up with Gravity, but it can be done with no other items with a gravity jump."
            }
          ]
        },
        {
          "leavesWithArtificialMorph": true,
          "strats": [
            {
              "name": "Carry G-Mode Morph Through Tube (Right to Left)",
              "notable": false,
              "requires": [
                {"comeInWithGMode": {
                  "fromNodes": [4],
                  "artificialMorph": true,
                  "mode": "any"
                }},
                {"or": [
                  "Morph",
                  "SpringBall",
                  {"and": [
                    "Gravity",
                    "h_canArtificialMorphIBJ"
                  ]},
                  {"and": [
                    "Gravity",
                    "h_canArtificialMorphBombHorizontally"
                  ]}
                ]}
              ],
              "note": "To save a bomb, it is possible to roll from the doorway onto the platform with Gravity turned off."
            }
          ]
        }
      ],
      "leaveWithGModeSetup": [
        {"strats": [
          {
            "name": "Get Hit By Sciser",
            "notable": false,
            "requires": []
          }
        ]}
      ],
      "gModeImmobile": {
        "requires": [
          {"enemyDamage": {
            "enemy": "Sciser",
            "type": "contact",
            "hits": 1
          }}
        ]
      }
    },
    {
      "id": 2,
      "name": "Bottom Left Door",
      "nodeType": "door",
      "nodeSubType": "blue",
      "nodeAddress": "0x001a510",
      "doorEnvironments": [{"physics": "water"}],
      "leaveWithGModeSetup": [
        {"strats": [
          {
            "name": "Get Hit By Sciser",
            "notable": false,
            "requires": []
          }
        ]}
      ],
      "gModeImmobile": {
        "requires": [
          {"enemyDamage": {
            "enemy": "Sciser",
            "type": "contact",
            "hits": 1
          }}
        ]
      }
    },
    {
      "id": 3,
      "name": "Bottom Right Door",
      "nodeType": "door",
      "nodeSubType": "red",
      "nodeAddress": "0x001a51c",
      "doorEnvironments": [{"physics": "water"}],
      "leaveWithGModeSetup": [
        {"strats": [
          {
            "name": "Get Hit By Sciser",
            "notable": false,
            "requires": []
          }
        ]}
      ],
      "gModeImmobile": {
        "requires": [
          {"enemyDamage": {
            "enemy": "Sciser",
            "type": "contact",
            "hits": 1
          }}
        ]
      },
      "locks": [
        {
          "name": "Crab Hole Red Lock (to Map)",
          "lockType": "coloredDoor",
          "unlockStrats": [
            {
              "name": "Base",
              "notable": false,
              "requires": [
                "h_canOpenRedDoors"
              ]
            }
          ]
        }
      ]
    },
    {
      "id": 4,
      "name": "Top Right Doorway",
      "nodeType": "door",
      "nodeSubType": "doorway",
      "nodeAddress": "0x001a504",
      "doorEnvironments": [{"physics": "water"}],
      "leaveWithGMode": [
        {
          "leavesWithArtificialMorph": false,
          "strats": [
            {
              "name": "Carry G-Mode Through Tube (Left to Right)",
              "notable": false,
              "requires": [
                {"comeInWithGMode": {
                  "fromNodes": [1],
                  "artificialMorph": false,
                  "mode": "any"
                }}
              ]
            },
            {
              "name": "Carry G-Mode Through Tube (Bottom to Right)",
              "notable": false,
              "requires": [
                {"comeInWithGMode": {
                  "fromNodes": [2, 3],
                  "artificialMorph": false,
                  "mode": "any"
                }},
                "Morph",
                {"or": [
                  "Gravity",
                  {"and": [
                    "canSuitlessMaridia",
                    "canUseFrozenEnemies",
                    "HiJump",
                    "h_canCrouchJumpDownGrab"
                  ]},
                  {"and": [
                    "canSuitlessMaridia",
                    {"ammo": {"type": "Super", "count": 1}},
                    "canTrickyUseFrozenEnemies",
                    "canOffScreenMovement"
                  ]},
                  {"and": [
                    "canSuitlessMaridia",
                    "canTrickyJump",
                    "canSpringBallJumpMidAir",
                    "canTrickyUseFrozenEnemies",
                    "canOffScreenMovement"
                  ]}
                ]}
              ],
              "note": "There is some off screen movement. Note that the crabs are global and will continue to move regardless of Samus' position.",
              "devNote": "There are many ways to get up with Gravity, but it can be done with no other items with a gravity jump."
            }
          ]
        },
        {
          "leavesWithArtificialMorph": true,
          "strats": [
            {
              "name": "Carry G-Mode Morph Through Tube (Left to Right)",
              "notable": false,
              "requires": [
                {"comeInWithGMode": {
                  "fromNodes": [1],
                  "artificialMorph": true,
                  "mode": "any"
                }},
                {"or": [
                  "Morph",
                  "SpringBall",
                  {"and": [
                    "Gravity",
                    "h_canArtificialMorphIBJ"
                  ]},
                  {"and": [
                    "Gravity",
                    "h_canArtificialMorphBombHorizontally",
                    {"or": [
                      "Bombs",
                      {"ammo": {"type": "PowerBomb", "count": 1}}
                    ]}
                  ]}
                ]}
              ]
            }
          ]
        }
      ],
      "leaveWithGModeSetup": [
        {"strats": [
          {
            "name": "Get Hit By Sciser",
            "notable": false,
            "requires": []
          }
        ]}
      ],
      "gModeImmobile": {
        "requires": [
          {"enemyDamage": {
            "enemy": "Sciser",
            "type": "contact",
            "hits": 1
          }}
        ]
      }
    }
  ],
  "enemies": [
    {
      "id": "e1",
      "groupName": "Crab Hole Scisers",
      "enemyName": "Sciser",
      "quantity": 4,
      "homeNodes": [1, 2, 3, 4],
      "note": "They move while offscreen and can easily be reached from anywhere in the room."
    }
  ],
  "links": [
    {
      "from": 1,
      "to": [
        {"id": 1},
        {"id": 2},
        {"id": 4}
      ]
    },
    {
      "from": 2,
      "to": [
        {"id": 1},
        {"id": 2},
        {"id": 3}
      ]
    },
    {
      "from": 3,
      "to": [
        {"id": 2},
        {"id": 3},
        {
          "id": 4,
          "devNote": "This link is only for the X-Ray climb and cross room jump. All other strats should go 3 -> 2 -> 1 -> 4."
        }
      ]
    },
    {
      "from": 4,
      "to": [
        {"id": 1},
        {"id": 4}
      ]
    }
  ],
  "strats": [
    {
      "link": [1, 1],
      "name": "Leave with Runway",
      "requires": [],
      "exitCondition": {
        "leaveWithRunway": {
          "length": 3,
          "openEnd": 1
        }
      }
    },
    {
      "link": [1, 1],
      "name": "Sciser Farm",
      "requires": [
        "h_canNavigateUnderwater",
        {"resetRoom": {
          "nodes": [1, 4],
          "mustStayPut": false
        }},
        {"refill": ["Energy", "PowerBomb"]}
      ]
    },
    {
      "link": [1, 1],
      "name": "Crystal Flash",
      "requires": [
        "h_canCrystalFlash"
      ]
    },
    {
      "link": [1, 2],
      "name": "Base",
      "requires": [
        "Morph"
      ]
    },
    {
      "link": [1, 2],
      "name": "G-Mode Morph",
      "requires": [
        {"comeInWithGMode": {
          "fromNodes": [1, 4],
          "mode": "any",
          "artificialMorph": true
        }}
      ],
      "note": "If coming from the top left door, roll over the two crabs before the first gets to Samus. This may be easier with Gravity Suit turned off."
    },
    {
      "link": [1, 4],
      "name": "Base",
      "requires": []
    },
    {
      "link": [1, 4],
      "name": "Shinespark Through Room",
      "entranceCondition": {
        "comeInWithSpark": {}
      },
      "requires": [
        {"or": [
          {"shinespark": {"frames": 24}},
          {"and": [
            "Gravity",
            {"shinespark": {"frames": 21}}
          ]}
        ]}
      ],
      "exitCondition": {
        "leaveWithSpark": {}
      }
    },
    {
      "link": [1, 4],
      "name": "Come In Shinecharging, Leave Shinecharged",
      "entranceCondition": {
        "comeInShinecharging": {
          "length": 2,
          "openEnd": 0
        }
      },
      "requires": [
        "Gravity",
        "canShinechargeMovement"
      ],
      "exitCondition": {
        "leaveShinecharged": {
          "framesRemaining": 80
        }
      }
    },
    {
      "link": [2, 1],
      "name": "Base",
      "requires": [
        "Morph",
        "Gravity",
        "h_canFly"
      ]
    },
    {
      "link": [2, 1],
      "name": "Gravity Jump",
      "requires": [
        "Morph",
        "canGravityJump"
      ]
    },
    {
      "link": [2, 1],
      "name": "Suited HiJump",
      "requires": [
        "Morph",
        "Gravity",
        "HiJump",
        "canWalljump"
      ]
    },
    {
      "link": [2, 1],
      "name": "Suited TrickyDashJump",
      "requires": [
        "Morph",
        "Gravity",
        "canWalljump",
        "canTrickyDashJump"
      ],
      "note": "Jump the first frame after running to gain just enough spinjump height."
    },
    {
      "link": [2, 1],
      "name": "Suited Frozen Sciser",
      "requires": [
        "Morph",
        "Gravity",
        "canUseFrozenEnemies"
      ],
      "note": [
        "The easiest way is probably to freeze a crab on the end of the ceiling, top walljump off it.",
        "Then it's possible to stand on it for an easy mid-air morph."
      ],
      "devNote": "It is possible to do without a wall jump, by freezing a crab at the bottom as a platform as well."
    },
    {
      "link": [2, 1],
      "name": "Crab Hole Left-Side X-Ray Climb",
      "entranceCondition": {
        "comeInWithDoorStuckSetup": {}
      },
      "requires": [
        "canXRayClimb"
      ],
      "note": "Climb up 1 screen."
    },
    {
      "link": [2, 1],
      "name": "Suitless HiJump",
      "requires": [
        "Morph",
        "canSuitlessMaridia",
        "canTrickyUseFrozenEnemies",
        "HiJump",
        "h_canCrouchJumpDownGrab"
      ],
      "note": [
        "Stand on a frozen crab, then freeze a second one on the edge of the hole above.",
        "It's reachable with crouch jump + downgrab."
      ]
    },
    {
      "link": [2, 1],
      "name": "Suitless Springball",
      "requires": [
        "Morph",
        "canSuitlessMaridia",
        {"ammo": {"type": "Super", "count": 1}},
        "canTrickyUseFrozenEnemies",
        "canSpringBallJumpMidAir"
      ],
      "note": "Use a super to knock off a crab and freeze it mid-air. Freeze a second crab on the edge of the hole above."
    },
    {
      "link": [2, 1],
      "name": "Crab Hole Suitless Crab Climb No Jump Assist",
      "notable": true,
      "requires": [
        "Morph",
        "canSuitlessMaridia",
        {"ammo": {"type": "Super", "count": 1}},
        "canTrickyUseFrozenEnemies"
      ],
      "note": [
        "Use a super to knock off a crab and freeze it mid-air. Then get on that crab, possibly using a door ledge",
        "Freeze a second crab on the edge of the hole above."
      ]
    },
    {
      "link": [2, 1],
      "name": "Crab Hole Suitless Crab Climb Superless with Springball",
      "notable": true,
      "requires": [
        "canSuitlessMaridia",
        "canTrickyJump",
        "canSpringBallJumpMidAir",
        "canTrickyUseFrozenEnemies",
        "canStationaryLateralMidAirMorph"
      ],
      "note": [
        "Freeze one crab on the lip of the overhead opening and another on the edge of a doors platform then springballjump up.",
        "Use a Stationary Lateral Mid-Air Morph to gain enough jump height without bonking the ceiling.",
        "It is possible with a crouch jump to not need the second crab."
      ],
      "devNote": "It is possible without canStationaryLateralMidAirMorph, but very precise."
    },
    {
      "link": [2, 1],
      "name": "Cross Room Jump with Kago",
      "entranceCondition": {
        "comeInJumping": {
          "speedBooster": false,
          "minTiles": 3.4375
        }
      },
      "requires": [
        "Morph",
        "canCrossRoomJumpIntoWater",
        "canMomentumConservingTurnaround",
        "canKago",
        {"enemyDamage": {
          "enemy": "Sciser",
          "type": "contact",
          "hits": 1
        }}
      ],
      "note": "Requires a runway of at least 4 tiles (with no open end) in the adjacent room."
    },
    {
      "link": [2, 1],
      "name": "Cross Room Jump with Air Ball",
      "entranceCondition": {
        "comeInJumping": {
          "speedBooster": false,
          "minTiles": 5.4375
        }
      },
      "requires": [
        "Morph",
        "canCrossRoomJumpIntoWater",
        "canLateralMidAirMorph",
        "canMomentumConservingTurnaround"
      ],
      "note": [
        "Only requires a runway of 6 tiles (with no open end) in the adjacent room.",
        "Perform an air ball while against the ceiling to make it up and through the morph tunnel."
      ]
    },
    {
      "link": [2, 1],
      "name": "Double Springball Jump",
      "requires": [
        "canSuitlessMaridia",
        "canDoubleSpringBallJumpMidAir"
      ]
    },
    {
      "link": [2, 1],
      "name": "G-Mode Morph IBJ",
      "requires": [
        {"comeInWithGMode": {
          "fromNodes": [2, 3],
          "mode": "any",
          "artificialMorph": true
        }},
        "h_canArtificialMorphIBJ",
        "Gravity"
      ],
      "note": [
        "One method to kill the crabs is to wait on the central platform until a crab comes near, then move with it laying bombs in its path.",
        "Another is to wait in the doorway and place three bombs to hit it while bouncing over it.",
        "The top of the IBJ will be off camera. Starting the IBJ as far to either side as possible and holding forward once off camera will make it easier to get through the morph tunnel."
      ]
    },
    {
      "link": [2, 2],
      "name": "Leave with Runway",
      "requires": [],
      "exitCondition": {
        "leaveWithRunway": {
          "length": 2,
          "openEnd": 1
        }
      }
    },
    {
      "link": [2, 2],
      "name": "Sciser Farm",
      "requires": [
        "h_canNavigateUnderwater",
        {"resetRoom": {
          "nodes": [2, 3],
          "mustStayPut": false
        }},
        {"refill": ["Energy", "PowerBomb"]}
      ]
    },
    {
      "link": [2, 2],
      "name": "Crystal Flash",
      "requires": [
        "h_canCrystalFlash"
      ]
    },
    {
      "link": [2, 3],
      "name": "Base",
      "requires": []
    },
    {
      "link": [2, 3],
      "name": "Come In Shinecharged, Leave Sparking",
      "entranceCondition": {
        "comeInShinecharged": {
          "framesRequired": 25
        }
      },
      "requires": [
        {"shinespark": {"frames": 23}}
      ],
      "exitCondition": {
        "leaveWithSpark": {}
      }
    },
    {
      "link": [3, 2],
      "name": "Base",
      "requires": []
    },
    {
      "link": [3, 2],
      "name": "Come In Shinecharged, Leave Sparking",
      "entranceCondition": {
        "comeInShinecharged": {
          "framesRequired": 25
        }
      },
      "requires": [
        {"shinespark": {"frames": 23}}
      ],
      "exitCondition": {
        "leaveWithSpark": {}
      }
    },
    {
      "link": [3, 3],
      "name": "Leave with Runway",
      "requires": [],
      "exitCondition": {
        "leaveWithRunway": {
          "length": 2,
          "openEnd": 1
        }
      }
    },
    {
      "link": [3, 4],
      "name": "Crab Hole Right-Side X-Ray Climb",
      "entranceCondition": {
        "comeInWithDoorStuckSetup": {}
      },
      "requires": [
        "canXRayClimb"
      ],
      "note": "Climb up 1 screen."
    },
    {
      "link": [3, 4],
      "name": "Cross Room Jump",
      "entranceCondition": {
        "comeInJumping": {
          "speedBooster": false,
          "minTiles": 3.4375
        }
      },
      "requires": [
        "Morph",
        "canCrossRoomJumpIntoWater",
        "canMomentumConservingTurnaround"
      ],
      "note": "Requires a runway of at least 4 tiles (with no open end) in the adjacent room."
    },
    {
      "link": [4, 1],
      "name": "Base",
      "requires": []
    },
    {
      "link": [4, 1],
      "name": "Shinespark Through Room",
      "entranceCondition": {
        "comeInWithSpark": {}
      },
      "requires": [
        {"or": [
          {"shinespark": {"frames": 24}},
          {"and": [
            "Gravity",
            {"shinespark": {"frames": 21}}
          ]}
        ]}
      ],
      "exitCondition": {
        "leaveWithSpark": {}
      }
    },
    {
      "link": [4, 1],
      "name": "Come In Shinecharging, Leave Shinecharged",
      "entranceCondition": {
        "comeInShinecharging": {
          "length": 2,
          "openEnd": 0
        }
      },
      "requires": [
        "Gravity",
        "canShinechargeMovement"
      ],
      "exitCondition": {
        "leaveShinecharged": {
          "framesRemaining": 80
        }
      }
    },
    {
      "link": [4, 4],
      "name": "Leave with Runway",
      "requires": [],
      "exitCondition": {
        "leaveWithRunway": {
          "length": 3,
          "openEnd": 1
        }
      }
    }
  ]
}
